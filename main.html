<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>For Grace ‚ù§Ô∏è</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
if(sessionStorage.getItem("unlocked")!=="true"){
  window.location.href="index.html";
}
</script>

<style>
body {
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#ffe4e1;
  font-family:"Comic Sans MS", cursive;
  text-align:center;
}

.container {
  background:white;
  padding:30px;
  border-radius:25px;
  box-shadow:0 10px 25px rgba(0,0,0,0.3);
  width:550px;
  max-width:95%;
  position:relative;
  overflow:hidden;
}

.sender {color:#ff3366;font-weight:bold;margin-top:10px;}

.buttons {margin-top:20px;position:relative;height:100px;width:100%;}

button {
  padding:15px 25px;
  border-radius:20px;
  border:none;
  font-size:1rem;
  cursor:pointer;
}

#yes {
  background:#ff3366;
  color:white;
  position:absolute;
  left:50%;
  transform:translateX(-120%);
  z-index:3;
}

#no {
  background:#999;
  color:white;
  position:absolute;
  left:50%;
  transform:translateX(20%);
  z-index:3;
}

/* Slideshow */
.slideshow {
  margin:15px auto;
  width:200px;
  height:150px;
  overflow:hidden;
  border-radius:15px;
}
.slideshow img {
  width:100%;
  height:100%;
  object-fit:cover;
  display:none;
}
.slideshow img.active {display:block;}

.volume-control{margin-top:10px;display:flex;gap:8px;justify-content:center;color:#ff3366;font-size:.8rem}
.volume-control input{width:150px}

/* SLIDER THEME */
input[type=range]{
  -webkit-appearance:none;
  appearance:none;
  height:6px;
  background:#ffd1dc;
  border-radius:10px;
}
input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:18px;
  height:18px;
  border-radius:50%;
  background:#ff3366;
  cursor:pointer;
  box-shadow:0 0 5px rgba(0,0,0,.3);
}
input[type=range]::-moz-range-thumb{
  width:18px;height:18px;border-radius:50%;background:#ff3366;cursor:pointer;
}
.song{font-size:.7rem;color:#ff3366}
</style>
</head>
<body>

<div class="container">
  <img src="assets/bunny.gif" width="120"><br>
  <div class="slideshow" id="slideshow"></div>

  <h2>Grace ‚ù§Ô∏è</h2>
  <h3>I love you Grace ‚ù§Ô∏è</h3>

  <h2>Will you be my val?</h2>

  <div class="buttons" id="buttonArea">
    <button id="yes">Yes üíñ</button>
    <button id="no">No üò¢</button>
  </div>

  
  <div class="sender">love, George ‚ù§Ô∏è</div>
  <p style="font-size:0.8rem;">Tap anywhere to start music üéµ</p>

  <div class="song" id="songName"></div>

  <div class="volume-control">
    üîä <input type="range" id="volume" min="0" max="1" step="0.01">
  </div>

</div>

<audio id="music" loop></audio>

<script>
/* MUSIC */
const songs=[1,2,3].map(i=>`assets/songs/love-song${i}.mp3`);
const audio=document.getElementById("music");
audio.src=songs[Math.floor(Math.random()*songs.length)];
document.getElementById("songName").textContent="üéµ "+audio.src.split("/").pop();

const volSlider=document.getElementById("volume");
let savedVol=localStorage.getItem("vol")||0.7;
audio.volume=savedVol;
volSlider.value=savedVol;

document.body.addEventListener("click",()=>audio.play(),{once:true});
volSlider.oninput=()=>{
  audio.volume=volSlider.value;
  localStorage.setItem("vol",volSlider.value);
  audio.play();
};

/* CONFETTI */
function confettiLaunch(){
  const c=document.createElement("canvas");
  c.style.position="absolute";
  c.style.top=0;
  c.style.left=0;
  c.style.zIndex=5;
  document.querySelector(".container").appendChild(c);
  const ctx=c.getContext("2d");
  c.width=c.parentElement.clientWidth;
  c.height=c.parentElement.clientHeight;
  let confetti=[];
  for(let i=0;i<120;i++){
    confetti.push({
      x:Math.random()*c.width,
      y:Math.random()*c.height,
      dx:(Math.random()-0.5)*6,
      dy:Math.random()*5+2,
      color:`hsl(${Math.random()*360},100%,50%)`
    });
  }
  function draw(){
    ctx.clearRect(0,0,c.width,c.height);
    confetti.forEach(p=>{
      ctx.fillStyle=p.color;
      ctx.fillRect(p.x,p.y,5,5);
      p.x+=p.dx;
      p.y+=p.dy;
      if(p.y>c.height) p.y=-5;
    });
    requestAnimationFrame(draw);
  }
  draw();
}

/* YES CLICK */
document.getElementById("yes").addEventListener("click",()=>{
  confettiLaunch();
  setTimeout(()=>location.href="celebrate.html",1200);
});

/* NO BUTTON */
const noBtn=document.getElementById("no");
const yesBtn=document.getElementById("yes");
const area=document.getElementById("buttonArea");

function isOverlapping(a,b){
  const r1=a.getBoundingClientRect();
  const r2=b.getBoundingClientRect();
  return !(r1.right<r2.left||r1.left>r2.right||r1.bottom<r2.top||r1.top>r2.bottom);
}
function moveNo(){
  const maxX=area.clientWidth-noBtn.offsetWidth;
  const maxY=area.clientHeight-noBtn.offsetHeight;
  let x,y;
  do{
    x=Math.random()*maxX;
    y=Math.random()*maxY;
    noBtn.style.left=x+"px";
    noBtn.style.top=y+"px";
  }while(isOverlapping(noBtn,yesBtn));
}
noBtn.addEventListener("mouseover",moveNo);
noBtn.addEventListener("touchstart",moveNo);

/* SLIDESHOW */
const imageList=[];
for(let i=1;i<=29;i++) imageList.push(`assets/images/her${i}.jpeg`);
const slideshow=document.getElementById("slideshow");
let currentSlide=0;

imageList.forEach((src,i)=>{
  const img=document.createElement("img");
  img.src=src;
  if(i===0) img.classList.add("active");
  slideshow.appendChild(img);
});

const slides=slideshow.querySelectorAll("img");
setInterval(()=>{
  slides[currentSlide].classList.remove("active");
  currentSlide=(currentSlide+1)%slides.length;
  slides[currentSlide].classList.add("active");
},2000);
</script>
</body>
</html>
