<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üéâ Celebration for Grace ‚ù§Ô∏è</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
// Protect page: cannot access if countdown not finished
if(sessionStorage.getItem("unlocked")!=="true"){
    window.location.href="index.html";
}
</script>

<style>
body {
    margin:0;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:#ffe4e1;
    font-family:"Comic Sans MS", cursive;
    text-align:center;
}

.container {
    background:white;
    padding:30px;
    border-radius:25px;
    box-shadow:0 10px 25px rgba(0,0,0,0.3);
    width:550px;
    max-width:95%;
    position:relative;
    overflow:hidden;
}

.sender {
    color:#ff3366;
    font-weight:bold;
    margin-top:10px;
}

.slideshow {
    margin:15px auto;
    width:200px;
    height:150px;
    overflow:hidden;
    border-radius:15px;
}

.slideshow img {
    width:100%;
    height:100%;
    object-fit:cover;
    display:none;
}

.slideshow img.active {
    display:block;
}

canvas {
    position:absolute;
    top:0;
    left:0;
    z-index:0;
}

.content {
    position:relative;
    z-index:2;
}

/* VOLUME UI */
.volume-control{
    margin-top:10px;
    display:flex;
    gap:8px;
    justify-content:center;
    align-items:center;
    color:#ff3366;
    font-size:0.8rem;
}

.song {
    font-size:0.7rem;
    color:#ff3366;
    margin-top:5px;
}

/* SLIDER THEME */
input[type=range]{
    -webkit-appearance:none;
    appearance:none;
    width:150px;
    height:6px;
    background:#ffd1dc;
    border-radius:10px;
}
input[type=range]::-webkit-slider-thumb{
    -webkit-appearance:none;
    width:18px;
    height:18px;
    border-radius:50%;
    background:#ff3366;
    cursor:pointer;
    box-shadow:0 0 5px rgba(0,0,0,.3);
}
input[type=range]::-moz-range-thumb{
    width:18px;
    height:18px;
    border-radius:50%;
    background:#ff3366;
    cursor:pointer;
}
</style>
</head>
<body>

<div class="container">
    <canvas id="fireworks"></canvas>

    <div class="content">
        <h1>Hurray! üíñ</h1>
        <h2>She said YES! üéâ</h2>

        <div class="slideshow" id="slideshow"></div>

        
        <div class="sender">love, George ‚ù§Ô∏è</div>
        <p style="font-size:0.8rem;">Tap anywhere to play music üéµ</p>
       
        <div class="song" id="songName"></div>

        <div class="volume-control">
            üîä <input type="range" id="volume" min="0" max="1" step="0.01">
        </div>
    </div>
</div>

<audio id="music" loop></audio>

<script>
/* RANDOM MUSIC */
const songs=[];
for (let i = 1; i <= 3; i++) {
  songs.push(`assets/songs/love-song${i}.mp3`);
}

const audio=document.getElementById("music");
const randomIndex=Math.floor(Math.random()*songs.length);
audio.src=songs[randomIndex];

document.getElementById("songName").textContent="üéµ "+audio.src.split("/").pop();

/* VOLUME */
const volSlider=document.getElementById("volume");
let savedVol=localStorage.getItem("vol")||0.7;
audio.volume=savedVol;
volSlider.value=savedVol;

document.body.addEventListener("click",()=>audio.play(),{once:true});

volSlider.oninput=()=>{
    audio.volume=volSlider.value;
    localStorage.setItem("vol",volSlider.value);
    audio.play();
};

/* SLIDESHOW */
const imageList = [];
for (let i = 1; i <= 29; i++) {
  imageList.push(`assets/images/her${i}.jpeg`);
}

const slideshow = document.getElementById("slideshow");
let currentSlide = 0;

imageList.forEach((src, index) => {
  const img = document.createElement("img");
  img.src = src;
  if (index === 0) img.classList.add("active");
  slideshow.appendChild(img);
});

const slides = slideshow.querySelectorAll("img");

setInterval(() => {
  slides[currentSlide].classList.remove("active");
  currentSlide = (currentSlide + 1) % slides.length;
  slides[currentSlide].classList.add("active");
}, 2000);

/* FIREWORKS */
const fwCanvas=document.getElementById("fireworks");
const fwCtx=fwCanvas.getContext("2d");

function resizeFw(){
    fwCanvas.width=fwCanvas.parentElement.clientWidth;
    fwCanvas.height=fwCanvas.parentElement.clientHeight;
}
resizeFw(); 
window.addEventListener("resize",resizeFw);

let fwParticles=[];
function firework(){
    for(let i=0;i<50;i++){
        fwParticles.push({
            x:fwCanvas.width/2,
            y:fwCanvas.height/2,
            dx:(Math.random()-0.5)*6,
            dy:(Math.random()-0.5)*6,
            life:80
        });
    }
}

function animateFw(){
    fwCtx.clearRect(0,0,fwCanvas.width,fwCanvas.height);
    fwParticles.forEach((p,i)=>{
        fwCtx.fillStyle="pink";
        fwCtx.fillRect(p.x,p.y,3,3);
        p.x+=p.dx;
        p.y+=p.dy;
        p.life--;
        if(p.life<=0) fwParticles.splice(i,1);
    });
    requestAnimationFrame(animateFw);
}

setInterval(firework,1400);
animateFw();
</script>

</body>
</html>
